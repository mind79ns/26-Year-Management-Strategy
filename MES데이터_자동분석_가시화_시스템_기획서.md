# MES 데이터 자동분석 & 현장 가시화 시스템

## 📋 프로젝트 개요

### **배경 및 필요성**

**현재 상황:**
- ✅ MES 시스템에 유실 등록 기능 **이미 구축됨**
- ✅ 작업자가 MES에서 유실 처리 **정상 운영 중**
- ⚠️ 유실조회는 **수동 조회만 가능** (실시간 데이터 제공 불가)
- ⚠️ 현장에서 **현황 파악 어려움** (MES 직접 들어가야 확인 가능)
- ⚠️ 데이터 **분석 및 활용 미흡**

**문제점:**
1. 담당자가 MES에 들어가서 직접 조회해야만 현황 파악 가능
2. 실시간 대응 어려움 (문제 발생 후 뒤늦게 인지)
3. 수동 집계로 시간 소요 (일일 리포트 작성에 30분 이상)
4. 현장 가시성 부족 (작업자들이 현황을 모름)
5. 데이터 활용도 낮음 (쌓이기만 하고 분석 안 됨)

**개선 방향:**
- ❌ **작업자 부담 증가 NO**: 추가 입력/등록 시스템 만들지 않음
- ✅ **기존 MES 활용**: 작업자는 기존 방식 그대로 유지
- ✅ **자동화 극대화**: 데이터 수집, 분석, 표시 모두 자동화
- ✅ **현장 가시화**: 대형 화면으로 실시간 현황 공유

---

## 🎯 프로젝트 목표

### **핵심 목표**
1. **자동 데이터 수집**: MES에서 주기적으로 유실 데이터 자동 추출
2. **자동 분석**: 수집된 데이터 실시간 분석 및 인사이트 도출
3. **현장 가시화**: 대형 TV로 현장에서 즉시 확인 가능
4. **작업자 부담 ZERO**: 기존 업무 프로세스 변경 없음

### **정량적 목표**
| 항목 | 현재 | 목표 | 개선율 |
|------|------|------|--------|
| 현황 파악 시간 | 5분 (수동 조회) | 0초 (자동 표시) | **100%** |
| 데이터 분석 시간 | 30분 (수동 집계) | 0초 (자동 분석) | **100%** |
| 현장 가시성 | 낮음 | 높음 (대형 화면) | **대폭 향상** |
| 대응 속도 | 사후 대응 | 준실시간 대응 | **10배 향상** |
| 작업자 추가 업무 | - | **0개** | **부담 없음** |

---

## 🏗️ 시스템 아키텍처

### **전체 구성도**

```
┌─────────────────────────────────────────────────┐
│              MES 시스템                          │
│         (기존 유실 등록 시스템)                  │
│                                                  │
│  - 작업자가 유실 발생 시 등록 (기존 방식)       │
│  - 유실조회 화면 제공 (수동 조회)               │
└──────────────────┬──────────────────────────────┘
                   │
                   │ ⏰ 5분마다 자동 조회
                   ▼
┌─────────────────────────────────────────────────┐
│          중간 처리 서버 (로컬 PC)               │
│                                                  │
│  🔄 자동 데이터 수집                            │
│     - MES 유실조회 화면 자동 접속               │
│     - 최신 데이터 자동 추출                     │
│     - 로컬 DB 저장 및 누적                      │
│                                                  │
│  📊 자동 분석 엔진                              │
│     - 라인별/설비별/원인별 집계                 │
│     - 시간대별 분포 분석                        │
│     - 트렌드 및 패턴 분석                       │
│     - 전일/전주 대비 비교                       │
│                                                  │
│  📈 리포트 생성                                 │
│     - 실시간 대시보드 데이터 생성               │
│     - 일일/주간/월간 리포트 자동 생성           │
└──────────────────┬──────────────────────────────┘
                   │
                   │ 🖥️ 분석 결과 전송
                   ▼
┌─────────────────────────────────────────────────┐
│         현장 대형 화면 (LINE별 TV)              │
│                                                  │
│  📺 실시간 대시보드                             │
│     - 금일 누적 유실 현황                       │
│     - 라인별 비교                               │
│     - 원인별 TOP 5                              │
│     - 시간대별 발생 분포                        │
│     - 경고 알림 (임계치 초과 시)                │
│                                                  │
│  ⏰ 5분마다 자동 갱신                           │
└─────────────────────────────────────────────────┘
```

---

## 🔧 세부 기능 명세

### **1. 자동 데이터 수집 모듈**

**기능:**
- MES 유실조회 화면에 5분 간격 자동 접속
- 최신 유실 데이터 자동 추출
- 로컬 DB에 저장 (중복 제거)
- 수집 로그 기록

**기술 구현:**
```python
# 방법 1: 웹 크롤링 (추천)
- Selenium으로 MES 로그인
- 유실조회 페이지 접속
- 테이블 데이터 파싱
- DB 저장

# 방법 2: MES DB 직접 읽기 (가능 시)
- DB 읽기 권한 확보
- SELECT 쿼리로 데이터 추출
- 더 빠르고 안정적

# 방법 3: CSV 자동 다운로드
- MES에서 CSV 내보내기 자동 실행
- 파일 파싱 후 DB 저장
```

**수집 데이터 항목:**
- 발생 일시
- 라인명 (LINE-A, B, C...)
- 설비명
- 유실 원인
- 정지 시간 (분)
- 조치 내용
- 작업자
- 주간/야간 구분

**수집 주기:**
- **5분마다 자동 실행**
- 실패 시 재시도 (3회)
- 야간 시간대도 계속 수집

---

### **2. 자동 분석 엔진**

**분석 항목:**

**A. 기본 집계**
- 금일 누적 유실 시간
- 라인별 유실 시간
- 설비별 유실 횟수
- 원인별 발생 횟수
- 주간/야간 비교

**B. 트렌드 분석**
- 시간대별 발생 분포 (08시, 10시, 12시...)
- 요일별 패턴
- 전일 대비 증감률
- 전주 대비 증감률

**C. 순위 분석**
- 유실 많은 라인 TOP 3
- 유실 많은 설비 TOP 5
- 주요 원인 TOP 5
- 개선 우수 라인

**D. 경고 알림**
- 라인별 유실 임계치 설정 (예: 1일 30분)
- 임계치 초과 시 경고 표시
- 연속 발생 감지 (같은 설비에서 3회 이상)

**분석 주기:**
- 데이터 수집 직후 즉시 분석 (5분마다)
- 자정에 일일 리포트 생성
- 월요일에 주간 리포트 생성

---

### **3. 현장 대형 화면 대시보드**

**화면 구성:**

```
┌────────────────────────────────────────────────────────┐
│  ⏱️ 순간유실 실시간 모니터링                          │
│  📅 2026-01-15 (수) 주간조    ⏰ 14:25 (5분 전 갱신)  │
├────────────────────────────────────────────────────────┤
│                                                         │
│  📊 금일 누적 현황 (08:00 ~ 현재)                     │
│  ┌─────────────────────────────────────────────┐      │
│  │ 전체: 45분 │ 주간: 45분 │ 전일 대비: ▼ 12%  │      │
│  └─────────────────────────────────────────────┘      │
│                                                         │
│  🏭 라인별 현황                                        │
│  ┌──────────┬──────────┬──────────┬──────────┐        │
│  │ LINE-A   │ LINE-B   │ LINE-C   │ LINE-D   │        │
│  │  15분    │  20분 ⚠️ │  10분    │   0분 ✅ │        │
│  │  🟢 양호  │  🟡 주의  │  🟢 양호  │  🟢 최고  │        │
│  │  3건     │  5건     │  2건     │  0건     │        │
│  └──────────┴──────────┴──────────┴──────────┘        │
│                                                         │
│  📈 시간대별 발생 분포        🔍 원인 TOP 5            │
│  ┌───────────────────┐       ┌──────────────┐         │
│  │ 08시 ████ 8분    │       │1. 센서 오작동│         │
│  │ 10시 ████████ 15분│       │   12회 (37%) │         │
│  │ 12시 ████ 7분    │       │2. 자재 대기  │         │
│  │ 14시 ██████████   │       │   8회 (25%)  │         │
│  │      15분 ⚠️      │       │3. 불량 처리  │         │
│  │                   │       │   5회 (15%)  │         │
│  │ ⚠️ 14시 집중 발생 │       │4. 금형 교체  │         │
│  │                   │       │   4회 (12%)  │         │
│  │                   │       │5. 청소       │         │
│  │                   │       │   3회 (9%)   │         │
│  └───────────────────┘       └──────────────┘         │
│                                                         │
│  💡 개선 포인트: LINE-B 센서 점검 필요 (5회 발생)     │
└────────────────────────────────────────────────────────┘
```

**색상 코드:**
- 🟢 **녹색**: 정상 범위 (목표 대비 100% 이내)
- 🟡 **노란색**: 주의 필요 (목표 대비 100~130%)
- 🔴 **빨간색**: 위험 수준 (목표 대비 130% 초과)

**자동 갱신:**
- 5분마다 자동 새로고침
- 애니메이션 효과로 변화 강조
- 경고 발생 시 깜박임 효과

---

### **4. 자동 리포트 생성**

**일일 리포트 (매일 08:00 자동 생성):**
```
[순간유실 일일 리포트 - 2026-01-15]

1. 전일 총 유실: 90분
   - 주간: 45분
   - 야간: 45분

2. 라인별 현황:
   - LINE-A: 30분 (3건)
   - LINE-B: 40분 (5건) ⚠️
   - LINE-C: 20분 (2건)

3. 주요 원인:
   - 센서 오작동: 15건 (40%)
   - 자재 대기: 10건 (27%)

4. 개선 포인트:
   - LINE-B 집중 관리 필요
   - 센서 점검 실시 권장
```

**주간 리포트 (매주 월요일):**
- 주간 총 유실 시간 및 트렌드
- 라인별 비교 차트
- 주요 개선 필요 사항
- 전주 대비 개선율

**월간 리포트:**
- 월간 유실 추이
- 월별 비교 (전월 대비)
- 개선 효과 분석
- 다음 달 개선 목표

---

## 💻 기술 스택

### **중간 서버 (데이터 수집 & 분석)**

**하드웨어:**
- 기존 PC 활용 (24시간 가동)
- CPU: 일반 사무용 수준
- RAM: 8GB 이상
- 저장공간: 100GB (데이터 축적용)

**소프트웨어:**
```
운영체제: Windows 10/11 or Linux
언어: Python 3.8+
웹 프레임워크: Flask / FastAPI (경량)
데이터베이스: SQLite (간단) or MySQL (확장성)
크롤링: Selenium (MES 자동 접속)
스케줄러: APScheduler (5분마다 실행)
```

**주요 라이브러리:**
```python
selenium        # MES 자동 조회
pandas          # 데이터 분석
sqlite3/pymysql # 데이터베이스
flask           # 웹 대시보드
schedule        # 자동 실행
```

---

### **현장 대형 화면**

**하드웨어:**
- 50인치 TV (LINE당 1대)
- 라즈베리파이 or 미니 PC
- HDMI 케이블

**소프트웨어:**
```
웹 브라우저: Chrome (키오스크 모드)
자동 새로고침: 5분마다
대시보드: 웹 기반 (HTML/CSS/JavaScript)
```

**디스플레이 설정:**
- 전체 화면 모드
- 절전 모드 비활성화
- 자동 로그인 설정
- 부팅 시 자동 실행

---

## 📊 데이터베이스 설계

### **테이블 구조**

**1. 유실 데이터 테이블 (loss_data)**

| 컬럼명 | 타입 | 설명 | 예시 |
|--------|------|------|------|
| id | INT (PK) | 고유 ID | 1 |
| timestamp | DATETIME | 발생 일시 | 2026-01-15 14:23:00 |
| line | VARCHAR(20) | 라인명 | LINE-A |
| shift | VARCHAR(10) | 주/야간 | 주간 |
| equipment | VARCHAR(50) | 설비명 | SMD-01 |
| cause | VARCHAR(100) | 원인 | 센서 오작동 |
| duration | INT | 정지 시간(분) | 5 |
| action | TEXT | 조치 내용 | 센서 청소 |
| operator | VARCHAR(50) | 작업자 | 홍길동 |
| created_at | DATETIME | 수집 시각 | 2026-01-15 14:25:00 |

**2. 일일 집계 테이블 (daily_summary)**

| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| date | DATE (PK) | 날짜 |
| line | VARCHAR(20) | 라인명 |
| total_loss | INT | 총 유실 시간(분) |
| count | INT | 발생 건수 |
| day_shift_loss | INT | 주간 유실 |
| night_shift_loss | INT | 야간 유실 |

**3. 원인별 통계 (cause_stats)**

| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| date | DATE | 날짜 |
| cause | VARCHAR(100) | 원인 |
| count | INT | 발생 횟수 |
| total_duration | INT | 총 시간(분) |

---

## 💰 투자 비용 및 ROI

### **초기 투자 비용**

| 항목 | 수량 | 단가 | 금액 |
|------|------|------|------|
| **하드웨어** | | | |
| 대형 TV (50인치) | 4대 | 30만원 | 120만원 |
| 라즈베리파이 | 4개 | 10만원 | 40만원 |
| 서버 PC | 1대 | 0원 | 0원 (기존 활용) |
| 케이블/설치 | 일식 | 20만원 | 20만원 |
| **소프트웨어** | | | |
| 개발 비용 | - | - | 100만원 |
| (외주 or 자체 개발) | | | |
| **합계** | | | **280만원** |

### **연간 운영 비용**

| 항목 | 금액 |
|------|------|
| 전기료 (24시간 가동) | 약 30만원/년 |
| 유지보수 | 약 50만원/년 |
| **합계** | **80만원/년** |

---

### **기대 효과 (정량적)**

| 항목 | 절감 효과 | 연간 환산 |
|------|-----------|----------|
| **시간 절감** | | |
| 현황 조회 시간 | 5분 → 0초 | 연 1,250시간 절감 |
| (1일 5회 조회) | (5분×5회×250일) | |
| 데이터 분석 시간 | 30분 → 0초 | 연 125시간 절감 |
| (1일 1회 분석) | (30분×250일) | |
| **인건비 절감** | | |
| 총 시간 절감 | 1,375시간 | |
| 시간당 인건비 | 3만원 | |
| **연간 절감액** | | **4,125만원** |
| **유실 개선 효과** | | |
| 대응 속도 향상 | 10배 | |
| 유실 시간 감소 | 15% | |
| (조기 발견/대응) | | |
| **추정 생산성 향상** | | **연 5,000만원** |

### **ROI 분석**

```
총 투자: 280만원
연간 효과: 4,125만원 (인건비) + 5,000만원 (생산성)
         = 9,125만원

ROI = (9,125 - 280) / 280 × 100 = 3,159%
투자 회수 기간 = 280 / (9,125/12) = 0.37개월 (약 11일!)
```

**결론: 투자 대비 효과가 매우 높음!** 🚀

---

## 📅 구축 일정

### **Phase 1: 시범 구축 (1개월)**

**Week 1-2: 개발**
- 데이터 수집 모듈 개발
- 데이터베이스 설계 및 구축
- 기본 분석 로직 구현

**Week 3: 테스트**
- 1개 라인 시범 운영
- 데이터 수집 안정성 검증
- 버그 수정

**Week 4: 대시보드 구축**
- 대형 화면 설치 (1대)
- 대시보드 UI 개발
- 실시간 표시 테스트

**산출물:**
- 작동하는 프로토타입
- 1개 라인 적용 완료
- 검증 리포트

---

### **Phase 2: 전체 적용 (1개월)**

**Week 5-6: 확대 적용**
- 전체 라인 대형 화면 설치 (3대 추가)
- 라인별 설정 및 조정
- 전 라인 데이터 수집 시작

**Week 7: 기능 고도화**
- 자동 리포트 기능 추가
- 경고 알림 기능 추가
- 트렌드 분석 강화

**Week 8: 안정화**
- 전체 시스템 안정화
- 작업자 교육 (기존 MES 등록 정확도 향상)
- 매뉴얼 작성

**산출물:**
- 전체 라인 적용 완료
- 작업자 교육 자료
- 운영 매뉴얼

---

### **Phase 3: 최적화 (진행 중)**

**지속적 개선:**
- 사용자 피드백 반영
- 분석 항목 추가
- 대시보드 UI 개선
- 리포트 항목 보강

---

## 🎯 기대 효과

### **정량적 효과**

| 구분 | 항목 | Before | After | 개선 |
|------|------|--------|-------|------|
| **시간** | 현황 파악 | 5분 | 0초 | **100%** ↓ |
| | 데이터 분석 | 30분 | 0초 | **100%** ↓ |
| | 리포트 작성 | 30분 | 0초 | **100%** ↓ |
| **가시성** | 현장 확인 | 불가능 | 즉시 가능 | **극대화** |
| **대응** | 대응 속도 | 느림 | 빠름 | **10배** ↑ |
| **정확성** | 데이터 정확도 | 80% | 95% | **15%p** ↑ |

### **정성적 효과**

**1. 투명성 향상**
- 전 직원이 현황을 실시간으로 공유
- 숨길 수 없는 투명한 운영
- 문제 인식 공유

**2. 경쟁 심리 유발**
- 라인 간 비교로 동기 부여
- "우리 라인이 제일 적게" 경쟁
- 자발적 개선 문화

**3. 데이터 기반 의사결정**
- 감이 아닌 데이터로 판단
- 개선 우선순위 명확화
- 효과 검증 가능

**4. 관리자 업무 효율**
- 수동 집계 불필요
- 핵심 업무에 집중
- 빠른 의사결정

**5. 작업자 부담 없음**
- 기존 방식 그대로 유지
- 추가 업무 ZERO
- 저항 없이 진행 가능

---

## ⚠️ 리스크 및 대응 방안

### **기술적 리스크**

**Risk 1: MES 접속 불안정**
- 문제: MES 시스템 다운 시 데이터 수집 불가
- 대응: 재시도 로직 (3회), 실패 로그 기록, 복구 후 자동 재개

**Risk 2: 데이터 누락**
- 문제: 네트워크 오류 등으로 일부 데이터 누락 가능
- 대응: 중복 체크, 누락 구간 자동 재수집

**Risk 3: 서버 다운**
- 문제: 서버 PC 고장 시 서비스 중단
- 대응: 자동 재시작 설정, 백업 서버 준비

---

### **운영 리스크**

**Risk 4: 작업자 등록 부정확**
- 문제: MES 등록을 제대로 안 하면 데이터 부정확
- 대응: 작업자 교육 강화, 등록율 모니터링, 인센티브 제도

**Risk 5: 화면 고장**
- 문제: TV 고장 시 가시화 불가
- 대응: 예비 화면 준비, 빠른 교체 체계

---

### **조직적 리스크**

**Risk 6: 저항 및 반발**
- 문제: "감시받는 느낌" 우려
- 대응:
  - 개선 목적 명확히 전달
  - 처벌 아닌 개선 도구 강조
  - 우수 라인 시상 제도

**Risk 7: 초기 정착 어려움**
- 문제: 익숙해지는 기간 필요
- 대응: 충분한 교육, 1개월 시범 운영

---

## 📝 성공 요인

### **Critical Success Factors**

1. ✅ **경영진 지원**: 예산 및 추진력 확보
2. ✅ **IT 부서 협조**: MES 접속 권한, 기술 지원
3. ✅ **현장 참여**: 작업자 적극적 참여 및 정확한 등록
4. ✅ **지속적 개선**: 피드백 반영 및 기능 고도화
5. ✅ **교육 및 홍보**: 목적 공유 및 사용법 교육

---

## 🚀 확장 가능성

### **향후 발전 방향**

**단기 (6개월):**
- 모바일 앱 추가 (관리자용 현황 조회)
- 알림 기능 (임계치 초과 시 문자 알림)
- 더 다양한 분석 차트

**중기 (1년):**
- AI 패턴 분석 (주요 원인 자동 도출)
- 예측 기능 (문제 발생 사전 예측)
- 타 시스템 연동 (품질, 설비 데이터)

**장기 (2년):**
- 전사 확대 (다른 팀 적용)
- 빅데이터 분석 (수년간 데이터 활용)
- 자동 개선 제안 시스템

---

## 📌 결론

### **핵심 메시지**

이 시스템은:
- ✅ **작업자 부담 ZERO**: 기존 방식 그대로
- ✅ **저비용 고효과**: 280만원으로 연 9천만원 효과
- ✅ **즉시 실행 가능**: 복잡한 기술 불필요
- ✅ **MES 독립 운영**: 실시간 연동 불필요
- ✅ **현장 가시화**: 모두가 볼 수 있는 투명성

### **추진 권고**

**즉시 시작 가능:**
1. Phase 1 시범 구축 (1개월, 50만원)
2. 효과 검증 후 전체 확대
3. 2개월 내 전체 적용 완료

**기대 효과:**
- 투자 회수: **11일**
- ROI: **3,159%**
- 순간유실 **15% 감소** 예상

---

**이 프로젝트는 저비용으로 큰 효과를 낼 수 있는 현실적이고 실행 가능한 혁신 과제입니다!** 🎯

---

## 📎 부록

### **A. 참고 화면 예시**
(대시보드 스크린샷 첨부 예정)

### **B. 기술 상세 문서**
(개발 가이드 별도 문서)

### **C. 교육 자료**
(작업자 교육 자료 별도 문서)

---

**문서 버전:** v1.0
**작성일:** 2026-01-15
**작성자:** 제조1팀
**검토자:** -
**승인자:** -
